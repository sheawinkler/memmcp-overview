<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="980" viewBox="0 0 1600 980" role="img" aria-label="Container and data-plane diagram with orchestrator, write fanout, retrieval synthesis, and learning loop">
  <defs>
    <linearGradient id="bg" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#192434"/>
      <stop offset="100%" stop-color="#111a25"/>
    </linearGradient>
    <radialGradient id="glowA" cx="25%" cy="8%" r="60%">
      <stop offset="0%" stop-color="#89a9d9" stop-opacity="0.26"/>
      <stop offset="100%" stop-color="#89a9d9" stop-opacity="0"/>
    </radialGradient>
    <radialGradient id="glowB" cx="88%" cy="10%" r="56%">
      <stop offset="0%" stop-color="#d2b883" stop-opacity="0.14"/>
      <stop offset="100%" stop-color="#d2b883" stop-opacity="0"/>
    </radialGradient>
    <marker id="arrowSync" markerWidth="10" markerHeight="10" refX="8" refY="5" orient="auto" markerUnits="userSpaceOnUse">
      <path d="M0 0 L10 5 L0 10 Z" fill="#deebfc"/>
    </marker>
    <marker id="arrowAsync" markerWidth="10" markerHeight="10" refX="8" refY="5" orient="auto" markerUnits="userSpaceOnUse">
      <path d="M0 0 L10 5 L0 10 Z" fill="#94d8e8"/>
    </marker>
    <marker id="arrowLearn" markerWidth="10" markerHeight="10" refX="8" refY="5" orient="auto" markerUnits="userSpaceOnUse">
      <path d="M0 0 L10 5 L0 10 Z" fill="#dcc18a"/>
    </marker>
    <style><![CDATA[
      .frame { fill: url(#bg); stroke: #69788b; stroke-width: 1.4; }
      .boundary { fill: rgba(255,255,255,0.02); stroke: #cdd8e8; stroke-width: 2; stroke-dasharray: 10 8; }
      .node { fill: #1f2b3a; stroke: #cfdbeb; stroke-width: 2; }
      .core { fill: #2b3d53; stroke: #e1eaf7; stroke-width: 2.2; }
      .title { font: 700 15px 'IBM Plex Mono', 'SF Mono', Menlo, monospace; fill: #d4deeb; text-transform: uppercase; letter-spacing: 0.09em; }
      .h1 { font: 700 34px 'IBM Plex Sans', 'Inter', sans-serif; fill: #eef4fd; }
      .h2 { font: 700 28px 'IBM Plex Sans', 'Inter', sans-serif; fill: #eef4fd; }
      .label { font: 700 32px 'IBM Plex Sans', 'Inter', sans-serif; fill: #f1f6ff; }
      .sub { font: 600 26px 'IBM Plex Sans', 'Inter', sans-serif; fill: #d2ddec; }
      .lane { font: 700 24px 'IBM Plex Sans', 'Inter', sans-serif; fill: #d8e3f2; }
      .small { font: 600 20px 'IBM Plex Sans', 'Inter', sans-serif; fill: #cfdae9; }
      .sync { stroke: #deebfc; stroke-width: 3; fill: none; stroke-linecap: round; stroke-linejoin: round; }
      .async { stroke: #94d8e8; stroke-width: 3; fill: none; stroke-dasharray: 10 8; stroke-linecap: round; stroke-linejoin: round; }
      .learn { stroke: #dcc18a; stroke-width: 3; fill: none; stroke-dasharray: 4 8; stroke-linecap: round; stroke-linejoin: round; }
      .plate { fill: rgba(17,24,35,0.88); stroke: #cdd8e8; stroke-width: 1.8; }
    ]]></style>
  </defs>

  <rect x="0" y="0" width="1600" height="980" class="frame"/>
  <rect x="0" y="0" width="1600" height="980" fill="url(#glowA)"/>
  <rect x="0" y="0" width="1600" height="980" fill="url(#glowB)"/>

  <text x="800" y="66" text-anchor="middle" class="title">Container Diagram: Context Lattice Runtime</text>

  <rect x="260" y="140" width="900" height="760" rx="120" class="boundary"/>
  <text x="710" y="194" text-anchor="middle" class="h2">Context Lattice System Boundary</text>

  <rect x="42" y="384" width="180" height="214" rx="38" class="node"/>
  <text x="132" y="452" text-anchor="middle" class="label">Clients</text>
  <text x="132" y="492" text-anchor="middle" class="sub">agents</text>
  <text x="132" y="528" text-anchor="middle" class="sub">messaging</text>
  <text x="132" y="564" text-anchor="middle" class="sub">apps</text>

  <rect x="560" y="240" width="320" height="108" rx="26" class="core"/>
  <text x="720" y="300" text-anchor="middle" class="label">Orchestrator API</text>
  <text x="720" y="338" text-anchor="middle" class="sub">HTTP ingress + auth + policy</text>

  <rect x="580" y="378" width="280" height="82" rx="20" class="node"/>
  <text x="720" y="430" text-anchor="middle" class="label">Ops + Security Gate</text>

  <rect x="340" y="508" width="250" height="98" rx="24" class="node"/>
  <text x="465" y="566" text-anchor="middle" class="label">Outbox Queue</text>
  <text x="465" y="602" text-anchor="middle" class="sub">durable async fanout</text>

  <rect x="850" y="508" width="250" height="98" rx="24" class="node"/>
  <text x="975" y="566" text-anchor="middle" class="label">Retrieval Engine</text>
  <text x="975" y="602" text-anchor="middle" class="sub">parallel recall + rerank</text>

  <rect x="310" y="662" width="780" height="220" rx="52" class="node"/>
  <text x="700" y="714" text-anchor="middle" class="h2">Memory Plane</text>

  <rect x="344" y="742" width="150" height="118" rx="24" class="node"/>
  <text x="419" y="798" text-anchor="middle" class="label">Memory Bank</text>
  <text x="419" y="834" text-anchor="middle" class="sub">canonical</text>

  <rect x="524" y="742" width="150" height="118" rx="24" class="node"/>
  <text x="599" y="798" text-anchor="middle" class="label">Qdrant</text>
  <text x="599" y="834" text-anchor="middle" class="sub">vectors</text>

  <rect x="704" y="742" width="150" height="118" rx="24" class="node"/>
  <text x="779" y="798" text-anchor="middle" class="label">Mongo</text>
  <text x="779" y="834" text-anchor="middle" class="sub">raw ledger</text>

  <rect x="884" y="742" width="186" height="118" rx="24" class="node"/>
  <text x="977" y="798" text-anchor="middle" class="label">MindsDB + Letta</text>
  <text x="977" y="834" text-anchor="middle" class="sub">SQL + archival</text>

  <rect x="1220" y="236" width="338" height="184" rx="40" class="node"/>
  <text x="1389" y="302" text-anchor="middle" class="label">Providers</text>
  <text x="1389" y="342" text-anchor="middle" class="sub">Qwen/Ollama, LM Studio</text>
  <text x="1389" y="378" text-anchor="middle" class="sub">OpenAI-compatible APIs</text>

  <rect x="1220" y="548" width="338" height="172" rx="40" class="node"/>
  <text x="1389" y="614" text-anchor="middle" class="label">Messaging Surfaces</text>
  <text x="1389" y="654" text-anchor="middle" class="sub">Telegram / Slack</text>
  <text x="1389" y="690" text-anchor="middle" class="sub">OpenClaw family</text>

  <rect x="1220" y="70" width="338" height="136" rx="28" class="plate"/>
  <text x="1250" y="112" class="small">Legend</text>
  <path class="sync" d="M1248 132 H1330" marker-end="url(#arrowSync)"/>
  <text x="1346" y="138" class="small">sync request/read</text>
  <path class="async" d="M1248 160 H1330" marker-end="url(#arrowAsync)"/>
  <text x="1346" y="166" class="small">async outbox fanout</text>
  <path class="learn" d="M1248 188 H1330" marker-end="url(#arrowLearn)"/>
  <text x="1346" y="194" class="small">learning feedback loop</text>

  <path class="sync" d="M222 492 H560" marker-end="url(#arrowSync)"/>
  <path class="sync" d="M560 526 H222" marker-end="url(#arrowSync)"/>

  <path class="sync" d="M720 348 V378" marker-end="url(#arrowSync)"/>
  <path class="sync" d="M640 460 V508" marker-end="url(#arrowSync)"/>
  <path class="sync" d="M800 460 V508" marker-end="url(#arrowSync)"/>

  <path class="sync" d="M880 294 H1220" marker-end="url(#arrowSync)"/>
  <path class="sync" d="M1100 558 H1220" marker-end="url(#arrowSync)"/>

  <text x="360" y="640" class="lane">Async Fanout</text>
  <path class="async" d="M465 606 V702 H977"/>
  <path class="async" d="M419 702 V742" marker-end="url(#arrowAsync)"/>
  <path class="async" d="M599 702 V742" marker-end="url(#arrowAsync)"/>
  <path class="async" d="M779 702 V742" marker-end="url(#arrowAsync)"/>
  <path class="async" d="M977 702 V742" marker-end="url(#arrowAsync)"/>

  <text x="700" y="640" class="lane">Parallel Retrieval</text>
  <path class="sync" d="M419 742 V680" marker-end="url(#arrowSync)"/>
  <path class="sync" d="M599 742 V680" marker-end="url(#arrowSync)"/>
  <path class="sync" d="M779 742 V680" marker-end="url(#arrowSync)"/>
  <path class="sync" d="M977 742 V680" marker-end="url(#arrowSync)"/>
  <path class="sync" d="M419 680 H977"/>
  <path class="sync" d="M977 680 V606" marker-end="url(#arrowSync)"/>

  <text x="1038" y="654" class="small" fill="#dcc18a">learning write</text>
  <path class="learn" d="M1020 606 C1080 640,1088 700,1012 742" marker-end="url(#arrowLearn)"/>
  <text x="1118" y="736" class="small" fill="#dcc18a">feedback return</text>
  <path class="learn" d="M977 844 C1138 836,1160 640,1080 584" marker-end="url(#arrowLearn)"/>
</svg>
