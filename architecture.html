<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Architecture | Context Lattice</title>
  <link rel="stylesheet" href="styles-gray.css?v=20260221c" />
</head>
<body class="home arch-page">
  <main class="container">
    <header class="topbar">
      <a class="brand" href="index.html">
        <span class="brand-mark" aria-hidden="true"></span>
        <span class="brand-copy"><span class="brand-label">Context Lattice</span><span class="brand-sub">By Private Memory Corp</span></span>
      </a>
      <nav class="nav" aria-label="Primary">
        <a href="index.html">Home</a>
        <a class="active" href="architecture.html">Architecture</a>
        <a href="updates.html">Updates</a>
        <a href="installation.html">Installation</a>
        <a href="integration.html">Integrations</a>
        <a href="troubleshooting.html">Troubleshooting</a>
        <a href="contact.html">Contact</a>
        <a href="v1/">v1</a>
      </nav>
    </header>

    <section class="hero">
      <span class="badge">System blueprint</span>
      <h1>Layered architecture for long-horizon memory, retrieval, and learning.</h1>
      <p class="sub">Context view shows boundaries. Container view shows responsibilities and protocol flow. Runtime view shows execution order.</p>
      <div class="cta-row">
        <a class="cta primary" href="index.html">Back to overview</a>
        <a class="cta secondary" href="installation.html">Install guide</a>
      </div>
    </section>

    <section class="section section-tight">
      <article class="card quick-path-card">
        <div class="kicker">Quick Path</div>
        <h3>How to read this architecture set</h3>
        <ol class="step-list">
          <li>Start with <strong>System Context</strong> to understand system boundaries.</li>
          <li>Move to <strong>Container View</strong> for service responsibilities and flow semantics.</li>
          <li>Use <strong>Runtime + Ops</strong> for sequence and reliability controls.</li>
        </ol>
      </article>
    </section>

    <section class="section section-tight">
      <nav class="page-nav-inline" aria-label="On this page">
        <a href="#arch-context">Context</a>
        <a href="#arch-container">Containers</a>
        <a href="#arch-runtime">Runtime</a>
        <a href="#arch-ops">Ops + Safety</a>
      </nav>
    </section>

    <section class="section" id="arch-context">
      <div class="kicker">C4 Level 1</div>
      <h2>System Context View</h2>
      <article class="card architecture-board">
        <svg class="arch-svg ive" viewBox="0 0 1320 700" role="img" aria-label="System context diagram showing external actors, Context Lattice boundary, and external dependencies">
          <defs>
            <radialGradient id="ive-glow" cx="50%" cy="34%" r="70%">
              <stop offset="0%" stop-color="#dcecff" stop-opacity="0.12"/>
              <stop offset="100%" stop-color="#dcecff" stop-opacity="0"/>
            </radialGradient>
            <marker id="ive-arrow-ctx" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
              <path d="M0,0 L8,4 L0,8 z" fill="#e3ecf7"></path>
            </marker>
          </defs>

          <rect x="0" y="0" width="1320" height="700" fill="url(#ive-glow)"></rect>
          <text class="arch-title" x="660" y="62" text-anchor="middle">System Context Diagram: Context Lattice</text>

          <rect class="ive-boundary" x="330" y="128" rx="24" ry="24" width="660" height="440"></rect>
          <text class="ive-title" x="660" y="174" text-anchor="middle">Context Lattice System Boundary</text>

          <rect class="ive-node" x="64" y="256" rx="18" ry="18" width="230" height="176"></rect>
          <text class="ive-label" x="179" y="304" text-anchor="middle">[A] External Actors</text>
          <text class="ive-sub" x="179" y="338" text-anchor="middle">Apps + agents</text>
          <text class="ive-sub" x="179" y="366" text-anchor="middle">MCP tools</text>
          <text class="ive-sub" x="179" y="394" text-anchor="middle">Messaging hooks</text>

          <rect class="ive-core" x="438" y="234" rx="20" ry="20" width="444" height="140"></rect>
          <text class="ive-label" x="660" y="288" text-anchor="middle">[B] Orchestrator Control Plane</text>
          <text class="ive-sub" x="660" y="320" text-anchor="middle">HTTP-first APIs + auth + policy</text>

          <rect class="ive-node" x="438" y="410" rx="16" ry="16" width="206" height="124"></rect>
          <text class="ive-label" x="541" y="460" text-anchor="middle">[C] Memory Plane</text>
          <text class="ive-sub" x="541" y="490" text-anchor="middle">stores + retrieval</text>

          <rect class="ive-node" x="676" y="410" rx="16" ry="16" width="206" height="124"></rect>
          <text class="ive-label" x="779" y="460" text-anchor="middle">[D] Ops + Safety</text>
          <text class="ive-sub" x="779" y="490" text-anchor="middle">queue + retention + security</text>

          <rect class="ive-node" x="1026" y="256" rx="18" ry="18" width="230" height="176"></rect>
          <text class="ive-label" x="1141" y="304" text-anchor="middle">[E] Dependencies</text>
          <text class="ive-sub" x="1141" y="338" text-anchor="middle">Model runtimes</text>
          <text class="ive-sub" x="1141" y="366" text-anchor="middle">Tool providers</text>
          <text class="ive-sub" x="1141" y="394" text-anchor="middle">Optional BYO cloud</text>

          <path class="ive-flow" d="M294 324 C360 324, 392 304, 438 304" marker-end="url(#ive-arrow-ctx)"></path>
          <path class="ive-flow" d="M882 304 C928 304, 960 324, 1026 324" marker-end="url(#ive-arrow-ctx)"></path>
          <path class="ive-flow" d="M660 374 C660 392, 604 404, 541 410" marker-end="url(#ive-arrow-ctx)"></path>
          <path class="ive-flow" d="M660 374 C660 392, 716 404, 779 410" marker-end="url(#ive-arrow-ctx)"></path>

          <rect class="ive-legend" x="1022" y="74" rx="12" ry="12" width="234" height="88"></rect>
          <text class="ive-sub" x="1046" y="108">Legend</text>
          <path class="ive-flow" d="M1046 130 L1118 130" marker-end="url(#ive-arrow-ctx)"></path>
          <text class="ive-sub" x="1130" y="135">Request flow</text>
        </svg>
        <p class="muted-note arch-caption">Context view keeps boundary and interaction semantics clear before implementation detail.</p>
      </article>
      <article class="card arch-note-card">
        <div class="kicker">Legend + Roles</div>
        <h3>What each context block means</h3>
        <ul class="spec-list arch-note-list">
          <li><strong>[A] External Actors:</strong> clients submitting memory writes and search requests.</li>
          <li><strong>[B] Orchestrator:</strong> single control plane for ingress, auth, validation, and routing.</li>
          <li><strong>[C] Memory Plane:</strong> durable stores used for fanout and retrieval synthesis.</li>
          <li><strong>[D] Ops + Safety:</strong> reliability controls for queue, storage, and policy.</li>
          <li><strong>[E] Dependencies:</strong> pluggable model/tool providers and optional cloud BYO services.</li>
        </ul>
      </article>
    </section>

    <section class="section" id="arch-container">
      <div class="kicker">C4 Level 2</div>
      <h2>Container and Data Plane View</h2>
      <article class="card architecture-board">
        <figure class="arch-diagram-figure">
          <img class="arch-diagram-image" src="assets/container-data-plane.svg?v=20260221g" alt="Container and data-plane diagram showing ingress, control gates, write fanout, retrieval synthesis, and learning loop" loading="lazy" decoding="async" />
        </figure>
        <p class="muted-note arch-caption">Container view emphasizes one ingress path, one durable fanout path, and one retrieval egress path.</p>
      </article>

      <article class="card arch-note-card">
        <div class="kicker">Container Notes</div>
        <h3>Responsibilities and protocol posture</h3>
        <ul class="spec-list arch-note-list">
          <li><strong>HTTP-first ingress:</strong> orchestrator is the single write/search endpoint.</li>
          <li><strong>MCP-compatible surface:</strong> tool clients connect through MCP hub + HTTP APIs.</li>
          <li><strong>Durable writes:</strong> outbox queue handles fanout retries and replay.</li>
          <li><strong>Retrieval egress:</strong> federated retrieval returns context and feedback prompts.</li>
          <li><strong>Local-first default:</strong> local stores first, cloud BYO optional.</li>
        </ul>
      </article>
    </section>

    <section class="section" id="arch-runtime">
      <div class="grid arch-grid">
        <article class="card">
          <div class="kicker">Dynamic View: Write Flow</div>
          <h3 class="runtime-flow-title">Write Flow</h3>
          <p class="muted-note">Order of operations</p>
          <ol class="step-list">
            <li>Authenticate and normalize write payload.</li>
            <li>Persist raw event for replay durability.</li>
            <li>Append async outbox fanout jobs.</li>
            <li>Dispatch sink writes with retries/backpressure.</li>
            <li>Record queue and sink telemetry.</li>
          </ol>
        </article>
        <article class="card">
          <div class="kicker">Dynamic View: Retrieval Flow</div>
          <h3 class="runtime-flow-title">Retrieval Flow</h3>
          <p class="muted-note">Order of operations</p>
          <ol class="step-list">
            <li>Receive scoped query (project/topic aware).</li>
            <li>Run parallel retrieval across sinks.</li>
            <li>Merge and rank candidates for retrieval egress.</li>
            <li>Prompt for context-quality feedback when useful.</li>
            <li>Write feedback signals to improve future ranking.</li>
          </ol>
        </article>
      </div>
    </section>

    <section class="section" id="arch-ops">
      <article class="card">
        <div class="kicker">Ops + Safety</div>
        <h3>Controls that keep long-horizon operation stable</h3>
        <ul class="spec-list">
          <li><strong>Queue durability:</strong> retries, deadletters, and replay workflows.</li>
          <li><strong>Write pressure management:</strong> backpressure + coalescing under burst load.</li>
          <li><strong>Storage hygiene:</strong> retention sweeps and external cold-path handoff.</li>
          <li><strong>Security posture:</strong> strict API-key auth and secrets redaction/block controls.</li>
          <li><strong>Operational confidence:</strong> health probes, telemetry, and update automation.</li>
        </ul>
      </article>
    </section>

    <footer class="footer">
      <span>Architecture reference</span>
      <span>Use this map for production troubleshooting and onboarding.</span>
    </footer>
  </main>
</body>
</html>
